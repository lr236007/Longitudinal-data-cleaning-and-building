setwd("/Users/Leslie/Repository/Dropbox/Eriko")
rm(list=ls())
ls()

#IF NEEDED= options(error=recover), THIS OPTIONS DEBUGS ERRORS.
#elementary, middle school and high school csv 2011
#CLEAN THE NAMES OF THE TWO DATA SETS

DIGEDUCA_E_MS_HS_2011<-read.csv('Resultados 2006_2009_2011.csv', header=TRUE)
dim(DIGEDUCA_E_MS_HS_2011)
head(DIGEDUCA_E_MS_HS_2011)
require(gtools)
require(gdata)
DIGEDUCA_E_MS_HS_2011<-rename.vars(DIGEDUCA_E_MS_HS_2011, c("PRIMER_NOMBRE","SEGUNDO_NOMBRE","PRIMER_APELLIDO","SEGUNDO_APELLIDO", "DESEMPENIO_LEC_2006", "LOGRO_LEC_2006", "MEASURE_L_2006", "DESEMPENIO_MATE_2006", "LOGRO_MATE_2006", "ID_UNICO_2006", "BARCODE_2009", "MEASURE_LECTURA_2009", "MEASURE_MATE_2009", "DESEMPENIO_LECTURA_2009", "DESEMPENIO_MATE_2009", "LOGRO_LECTURA_2009", "LOGRO_MATEMATICAS_2009", "MEASURE_LECTURA_2011", "MEASURE_MATE_2011", "DESEMPENIO_LECTURA_2011", "DESEMPENIO_MATE_2011", "LOGRO_LECTURA_2011", "LOGRO_MATE_2011"), c("FIRST_NAME", "MIDDLE_NAME", "LAST_NAME_1", "LAST_NAME_2", "STAND_READ_2006", "LOGRO_READ_2006", "SS_READ_2006", "STAND_MATH_2006", "LOGRO_MATH_2006", "MATCH_VAR_2006", "MATCH_VAR_2009", "SS_READ_2009", "SS_MATH_2009", "STAND_READ_2009", "STAND_MATH_2009", "LOGRO_READ_2009", "LOGRO_MATH_2009", "SS_READ_HS", "SS_MATH_HS", "STAND_READ_HS", "STAND_MATH_HS", "LOGRO_READ_HS", "LOGRO_MATH_HS"))

DIGEDUCA_E_MS_HS_2011<-rename.vars(DIGEDUCA_E_MS_HS_2011, c("COD_ESC_2006","COD_DEPA_2006","COD_MUNI_2006","COD_AREA_2006", "COD_SECT_2006", "COD_JORN_2006", "COD_PLAN_2006", "ENTIA_R_2006", "CODIGO_ESTABLECIMIENTO_2009", "CODIGO_DEPARTAMENTO_2009", "CODIGO_MUNICIPIO_2009", "CODIGO_JORNADA_2009", "CODIGO_NIVEL_2009", "CODIGO_SECTOR_2009", "CODIGO_AREA_2009", "EDAD_RECODE_2009", "SEXO_2009", "IE_IDENTIFICACION_ETNICA_2009", "IE_IDIOMA_MATERNO_2009", "BARCODE_2011", "COD_DEPA_2011", "COD_MUNI_2011","COD_ESTAB_2011", "EDAD_RECODE_2011", "SEXO_2011", "COD_AREA_2011", "COD_SECTOR_2011", "COD_JORNADA_2011", "IE_IDENTIFICACION_ETNICA_2011", "IE_IDIOMA_MATERNO_2011"), c("SCHOOL_2006", "STATE_2006", "DISTRICT_2006", "AREA_2006", "SECTOR_2006", "JORN_2006", "PLAN_2006", "ETHNICITY_2006", "SCHOOL_2009", "STATE_2009", "DISTRICT_2009", "JORN_2009", "LEVEL_2009", "SECTOR_2009", "AREA_2009", "AGE_2009", "SEX_2009", "ETHNICITY_2009", "LANG_2009", "MATCH_VAR_HS", "STATE_HS", "DISTRICT_HS","SCHOOL_HS", "AGE_HS", "SEX_HS", "AREA_HS", "SECTOR_HS", "JORN_HS", "ETHNICITY_HS", "LANG_HS"))

#CHECK CODINGS AND REMOVE UNNECESSARY VARIABLES
cor(DIGEDUCA_E_MS_HS_2011$SEX_2009, DIGEDUCA_E_MS_HS_2011$SEX_HS) #NEGATIVE, THEY RECODED THE VARIABLE OPPOSITE.
head(DIGEDUCA_E_MS_HS_2011)
DIGEDUCA_E_MS_HS_2011[34,]
#RECODE DEMOGRAPHIC VARIABLES #this does not work!  
#REQUIRE PACKAGE: car
require(car)
help(car)
#??car
#recode sex variable to match both years: 0= girls and 1= boys
DIGEDUCA_E_MS_HS_2011$SEX_HS<-recode(DIGEDUCA_E_MS_HS_2011$SEX_HS,"c(1)='0';c(0)='1';else='NA'")
#recode ethnicity variables to be consistent accross years: maya = 1, ladino =2, garifuna = 3, xinka = 4, foreign= 5, else= missing
DIGEDUCA_E_MS_HS_2011$ETHNICITY_2006<-recode(DIGEDUCA_E_MS_HS_2011$ETHNICITY_2006,"c(1,2,3,5,6,7,9,10,11,12,13,14,15,16)='1';c(8)='2';c(4)='3';else='NA'")
DIGEDUCA_E_MS_HS_2011$ETHNICITY_2009<-recode(DIGEDUCA_E_MS_HS_2011$ETHNICITY_2009,"c(1)='1';c(2)='2';c(3)='3';c(4)='4';c(5)='5';else='NA'")
DIGEDUCA_E_MS_HS_2011$ETHNICITY_HS<-recode(DIGEDUCA_E_MS_HS_2011$ETHNICITY_HS,"c(1)='1';c(2)='2';c(3)='3';c(4)='4';c(5)='5';else='NA'")

#recode language to be consistent accross years: 1=spanish, 2= maya, 3=garifuna, 4=xinka, 5=foreign, else=missing
DIGEDUCA_E_MS_HS_2011$LANG_2009<-recode(DIGEDUCA_E_MS_HS_2011$LANG_2009,"c(1)='1';c(2)='2';c(4)='3';c(5)='4';c(3)='5';else='NA'")
DIGEDUCA_E_MS_HS_2011$LANG_HS<-recode(DIGEDUCA_E_MS_HS_2011$LANG_HS,"c(1)='1';c(2)='2';c(4)='3';c(5)='4';c(3)='5';else='NA'")


#CONSIDER: remove sex high school and kept 2009 coding
#DIGEDUCA_E_MS_HS_2011<-remove.vars(DIGEDUCA_E_MS_HS_2011,"SEX_HS")

#convert variables to numeric variables
DIGEDUCA_E_MS_HS_2011$ETHNICITY_2006<-as.numeric(DIGEDUCA_E_MS_HS_2011$ETHNICITY_2006, 'NA'=TRUE)
DIGEDUCA_E_MS_HS_2011$ETHNICITY_2009<-as.numeric(DIGEDUCA_E_MS_HS_2011$ETHNICITY_2009, 'NA'=TRUE)
DIGEDUCA_E_MS_HS_2011$ETHNICITY_HS <-as.numeric(DIGEDUCA_E_MS_HS_2011$ETHNICITY_HS, 'NA'=TRUE)
DIGEDUCA_E_MS_HS_2011$LANG_2009<-as.numeric(DIGEDUCA_E_MS_HS_2011$LANG_2009, 'NA'=TRUE)
DIGEDUCA_E_MS_HS_2011$LANG_HS <-as.numeric(DIGEDUCA_E_MS_HS_2011$LANG_HS, 'NA'=TRUE)
summary(DIGEDUCA_E_MS_HS_2011)
#in case need to change column names:
#colnames(dataset)[2]<-"newname" ,then you change column 2 to "newname" 

#elementary, middle school and high school csv 2012
DIGEDUCA_E_MS_HS_2012<-read.csv('Resultados 2006_2009_2012.csv', header=TRUE)
head(DIGEDUCA_E_MS_HS_2012)
dim(DIGEDUCA_E_MS_HS_2012)
DIGEDUCA_E_MS_HS_2012<-rename.vars(DIGEDUCA_E_MS_HS_2012, c("PRIMER_NOMBRE","SEGUNDO_NOMBRE","PRIMER_APELLIDO","SEGUNDO_APELLIDO", "DESEMPENIO_LEC_2006", "LOGRO_LEC_2006", "MEASURE_L_2006", "DESEMPENIO_MATE_2006", "LOGRO_MATE_2006", "ID_UNICO_2006", "BARCODE_2009", "MEASURE_LECTURA_2009", "MEASURE_MATE_2009", "DESEMPENIO_LECTURA_2009", "DESEMPENIO_MATE_2009", "LOGRO_LECTURA_2009", "LOGRO_MATEMATICAS_2009", "MEASURE_LECTURA_2012", "MEASURE_MATE_2012", "DESEMPENIO_LECTURA_2012", "DESEMPENIO_MATE_2012", "LOGRO_LECTURA_2012", "LOGRO_MATE_2012"), c("FIRST_NAME", "MIDDLE_NAME", "LAST_NAME_1", "LAST_NAME_2", "STAND_READ_2006", "LOGRO_READ_2006", "SS_READ_2006", "STAND_MATH_2006", "LOGRO_MATH_2006", "MATCH_VAR_2006", "MATCH_VAR_2009", "SS_READ_2009", "SS_MATH_2009", "STAND_READ_2009", "STAND_MATH_2009", "LOGRO_READ_2009", "LOGRO_MATH_2009", "SS_READ_HS", "SS_MATH_HS", "STAND_READ_HS", "STAND_MATH_HS", "LOGRO_READ_HS", "LOGRO_MATH_HS"))

DIGEDUCA_E_MS_HS_2012<-rename.vars(DIGEDUCA_E_MS_HS_2012, c("COD_ESC_2006","COD_DEPA_2006","COD_MUNI_2006","COD_AREA_2006", "COD_SECT_2006", "COD_JORN_2006", "COD_PLAN_2006", "ENTIA_R_2006", "CODIGO_ESTABLECIMIENTO_2009", "CODIGO_DEPARTAMENTO_2009", "CODIGO_MUNICIPIO_2009", "CODIGO_JORNADA_2009", "CODIGO_NIVEL_2009", "CODIGO_SECTOR_2009", "CODIGO_AREA_2009", "EDAD_RECODE_2009", "SEXO_2009", "IE_IDENTIFICACION_ETNICA_2009", "IE_IDIOMA_MATERNO_2009", "BARCODE_2012", "COD_DEPA_2012", "COD_MUNI_2012","COD_ESTAB_2012", "EDAD_RECODIFICADA_2012", "SEXO_2012", "COD_AREA_2012", "COD_SECTOR_2012", "COD_JORNADA_2012", "IE_IDENTIFICACION_ETNICA_2012", "IE_IDIOMA_MATERNO_2012"), c("SCHOOL_2006", "STATE_2006", "DISTRICT_2006", "AREA_2006", "SECTOR_2006", "JORN_2006", "PLAN_2006", "ETHNICITY_2006", "SCHOOL_2009", "STATE_2009", "DISTRICT_2009", "JORN_2009", "LEVEL_2009", "SECTOR_2009", "AREA_2009", "AGE_2009", "SEX_2009", "ETHNICITY_2009", "LANG_2009", "MATCH_VAR_HS", "STATE_HS", "DISTRICT_HS","SCHOOL_HS", "AGE_HS", "SEX_HS", "AREA_HS", "SECTOR_HS", "JORN_HS", "ETHNICITY_HS", "LANG_HS"))

#RECODE DEMOGRAPHIC VARIABLES 
#NO NEED TO RECODE SEX FOR 2012 DATA SET
#REQUIRE PACKAGE: car
require(car)
help(car)
#??car
DIGEDUCA_E_MS_HS_2012$ETHNICITY_2006<-recode(DIGEDUCA_E_MS_HS_2012$ETHNICITY_2006,"c(1,2,3,5,6,7,9,10,11,12,13,14,15,16)='1';c(8)='2';c(4)='3';else='NA'")
DIGEDUCA_E_MS_HS_2012$ETHNICITY_2009<-recode(DIGEDUCA_E_MS_HS_2012$ETHNICITY_2009,"c(1)='1';c(2)='2';c(3)='3';c(4)='4';c(5)='5';else='NA'")
DIGEDUCA_E_MS_HS_2012$ETHNICITY_HS<-recode(DIGEDUCA_E_MS_HS_2012$ETHNICITY_HS,"c(1)='1';c(2)='2';c(3)='3';c(4)='4';c(5)='5';else='NA'")
#recode language to be consistent accross years: 1=spanish, 2= maya, 3=garifuna, 4=xinka, 5=foreign, else=missing
DIGEDUCA_E_MS_HS_2012$LANG_2009<-recode(DIGEDUCA_E_MS_HS_2012$LANG_2009,"c(1)='1';c(2)='2';c(4)='3';c(5)='4';c(3)='5';else='NA'")
DIGEDUCA_E_MS_HS_2012$LANG_HS<-recode(DIGEDUCA_E_MS_HS_2012$LANG_HS,"c(1)='1';c(2)='2';c(3)='3';c(4)='4';c(5)='5';else='NA'")




#convert variables to numeric variables
DIGEDUCA_E_MS_HS_2012$ETHNICITY_2006<-as.numeric(DIGEDUCA_E_MS_HS_2012$ETHNICITY_2006, 'NA'=TRUE)
DIGEDUCA_E_MS_HS_2012$ETHNICITY_2009<-as.numeric(DIGEDUCA_E_MS_HS_2012$ETHNICITY_2009, 'NA'=TRUE)
DIGEDUCA_E_MS_HS_2012$ETHNICITY_HS <-as.numeric(DIGEDUCA_E_MS_HS_2012$ETHNICITY_HS, 'NA'=TRUE)
DIGEDUCA_E_MS_HS_2012$LANG_2009 <-as.numeric(DIGEDUCA_E_MS_HS_2012$LANG_2009, 'NA'=TRUE)
DIGEDUCA_E_MS_HS_2012$LANG_HS <-as.numeric(DIGEDUCA_E_MS_HS_2012$LANG_HS, 'NA'=TRUE)
summary(DIGEDUCA_E_MS_HS_2012)
DIGEDUCA_E_MS_HS_2012[6,]
#CONSIDERremove sex high school and kept 2009 coding
DIGEDUCA_E_MS_HS_2011<-remove.vars(DIGEDUCA_E_MS_HS_2011,"SEX_HS")

#MERGE THE TWO DATA SETS including elementary cases (sixth cases)

DIGEDUCA_E_MS_HS<-rbind(DIGEDUCA_E_MS_HS_2011, DIGEDUCA_E_MS_HS_2012)
head(DIGEDUCA_E_MS_HS)
dim(DIGEDUCA_E_MS_HS) #N=2,746
summary(DIGEDUCA_E_MS_HS)

#CREATE GRADE AND ID VARIABLES
DIGEDUCA_E_MS_HS$GRADE_2006<-6
DIGEDUCA_E_MS_HS$GRADE_2009<-9
DIGEDUCA_E_MS_HS$GRADE_HS<-12
#DIGEDUCA_E_MS_HS$GRADE_2012<-12
#DIGEDUCA_E_MS_HS<-remove.vars(DIGEDUCA_E_MS_HS, "GRADE_HS")

#CREATE A UNIQUE IDENTIFIER
DIGEDUCA_E_MS_HS$ID<-as.numeric(as.factor(with(DIGEDUCA_E_MS_HS,paste(FIRST_NAME, MIDDLE_NAME, LAST_NAME_1, LAST_NAME_2, STAND_READ_2006, LOGRO_READ_2006, SS_READ_2006, STAND_MATH_2006, LOGRO_MATH_2006, MATCH_VAR_2006, MATCH_VAR_2009, SS_READ_2009, SS_MATH_2009, STAND_READ_2009, STAND_MATH_2009, LOGRO_READ_2009, LOGRO_MATH_2009, SS_READ_HS, SS_MATH_HS, STAND_READ_HS, STAND_MATH_HS, LOGRO_READ_HS, LOGRO_MATH_HS, SCHOOL_2006, STATE_2006, DISTRICT_2006, AREA_2006, SECTOR_2006, JORN_2006, PLAN_2006, ETHNICITY_2006, SCHOOL_2009, STATE_2009, DISTRICT_2009, JORN_2009, LEVEL_2009, SECTOR_2009, AREA_2009, AGE_2009, SEX_2009, ETHNICITY_2009, LANG_2009, MATCH_VAR_HS, STATE_HS, DISTRICT_HS,SCHOOL_HS, AGE_HS, SEX_HS, AREA_HS, SECTOR_HS, JORN_HS, ETHNICITY_HS, LANG_HS, sep="_"))))

#check data fit of this N (it does not run it because the sample size is too small???)
require(SGP)
sgp_DIGEDUCA_Reading <- studentGrowthPercentiles(panel.data=DIGEDUCA_E_MS_HS,
                   sgp.labels=list(my.year=2012, my.subject="Reading"),
                   panel.data.vnames=c("ID","GRADE_2006", "GRADE_2009", "GRADE_HS", "SS_READ_2006", "SS_READ_2009", "SS_READ_HS"),
                   percentile.cuts=c(1,35,65,99),
                   percuts.digits=2,
                   drop.nonsequential.grade.progression.variables=FALSE,
                   grade.progression=c(6,9,12))
                   
dim(DIGEDUCA_E_MS_HS)
names(sgp_DIGEDUCA_Reading$SGPercentiles)
help(SGP)
grid.draw(sgp_DIGEDUCA_Reading$Goodness_of_Fit$READING.2012[["GRADE_9_2009-12_2012"]])


#DATA FROM 2009-2011 COHORT.  STUDENTS THAT DID 2 YEAR HIGH SCHOOL. #falta barcode de 2011.  
DIGEDUCA_2009_2011<-read.csv('Resultados 2009_2011.csv',header=TRUE)
names(DIGEDUCA_2009_2011)
dim(DIGEDUCA_2009_2011)
head(DIGEDUCA_2009_2011)
DIGEDUCA_MS_HS_2011<-rename.vars(DIGEDUCA_2009_2011, c(
	"PRIMER_NOMBRE",
	"SEGUNDO_NOMBRE",
	"PRIMER_APELLIDO",
	"SEGUNDO_APELLIDO", 
	"BARCODE_2009", 
	"MEASURE_LECTURA_2009", 
	"MEASURE_MATE_2009", 
	"DESEMPENIO_LECTURA_2009", 
	"DESEMPENIO_MATE_2009", 
	"LOGRO_LECTURA_2009", 
	"LOGRO_MATEMATICAS_2009", 
	"MEASURE_LECTURA_2011", 
	"MEASURE_MATE_2011", 
	"DESEMPENIO_LECTURA_2011", 
	"DESEMPENIO_MATE_2011", 
	"LOGRO_LECTURA_2011", 
	"LOGRO_MATE_2011", 
	"CODIGO_ESTABLECIMIENTO_2009", 
	"CODIGO_DEPARTAMENTO_2009", 
	"CODIGO_MUNICIPIO_2009", 
	"CODIGO_JORNADA_2009", 
	"CODIGO_NIVEL_2009", 
	"CODIGO_SECTOR_2009", 
	"CODIGO_AREA_2009", 
	"EDAD_RECODE_2009", 
	"SEXO_2009", 
	"IE_IDENTIFICACION_ETNICA_2009", 
	"IE_IDIOMA_MATERNO_2009", 
	"BARCODE_2011", 
	"COD_DEPA_2011", 
	"COD_MUNI_2011",
	"COD_ESTAB_2011", 
	"EDAD_RECODE_2011", 
	"SEXO_2011", 
	"COD_AREA_2011", 
	"COD_SECTOR_2011", 
	"COD_JORNADA_2011", 
	"IE_IDENTIFICACION_ETNICA_2011", 
	"IE_IDIOMA_MATERNO_2011"), 
	
	c("FIRST_NAME", 
	"MIDDLE_NAME", 
	"LAST_NAME_1", 
	"LAST_NAME_2", 
	"MATCH_VAR_2009", 
	"SS_READ_2009", 
	"SS_MATH_2009", 
	"STAND_READ_2009", 
	"STAND_MATH_2009", 
	"LOGRO_READ_2009", 
	"LOGRO_MATH_2009", 
	"SS_READ_HS", 
	"SS_MATH_HS", 
	"STAND_READ_HS", 
	"STAND_MATH_HS", 
	"LOGRO_READ_HS", 
	"LOGRO_MATH_HS",
	"SCHOOL_2009", 
	"STATE_2009", 
	"DISTRICT_2009", 
	"JORN_2009", 
	"LEVEL_2009", 
	"SECTOR_2009", 
	"AREA_2009", 
	"AGE_2009", 
	"SEX_2009", 
	"ETHNICITY_2009", 
	"LANG_2009", 
	"MATCH_VAR_HS", 
	"STATE_HS", 
	"DISTRICT_HS",
	"SCHOOL_HS", 
	"AGE_HS", 
	"SEX_HS", 
	"AREA_HS", 
	"SECTOR_HS", 
	"JORN_HS", 
	"ETHNICITY_HS", 
	"LANG_HS"))

#DIGEDUCA_MS_HS_2011<-rename.vars(DIGEDUCA_2009_2011, c("CODIGO_ESTABLECIMIENTO_2009", "CODIGO_DEPARTAMENTO_2009", "CODIGO_MUNICIPIO_2009", "CODIGO_JORNADA_2009", "CODIGO_NIVEL_2009", "CODIGO_SECTOR_2009", "CODIGO_AREA_2009", "EDAD_RECODE_2009", "SEXO_2009", "IE_IDENTIFICACION_ETNICA_2009", "IE_IDIOMA_MATERNO_2009", "BARCODE_2011", "COD_DEPA_2011", "COD_MUNI_2011","COD_ESTAB_2011", "EDAD_RECODE_2011", "SEXO_2011", "COD_AREA_2011", "COD_SECTOR_2011", "COD_JORNADA_2011", "IE_IDENTIFICACION_ETNICA_2011", "IE_IDIOMA_MATERNO_2011"), c("SCHOOL_2009", "STATE_2009", "DISTRICT_2009", "JORN_2009", "LEVEL_2009", "SECTOR_2009", "AREA_2009", "AGE_2009", "SEX_2009", "ETHNICITY_2009", "LANG_2009", "MATCH_VAR_HS", "STATE_HS", "DISTRICT_HS","SCHOOL_HS", "AGE_HS", "SEX_HS", "AREA_HS", "SECTOR_HS", "JORN_HS", "ETHNICITY_HS", "LANG_HS"))


names(DIGEDUCA_MS_HS_2011)
dim(DIGEDUCA_MS_HS_2011)

#DATA FROM 2009-2012 COHORT. STUDENTS THAT DID A 3 YEAR HIGH SCHOOL.
DIGEDUCA_2009_2012<-read.csv('Resultados 2009_2012.csv',header=TRUE)
names(DIGEDUCA_2009_2012)
dim(DIGEDUCA_2009_2012)
head(DIGEDUCA_2009_2012)

DIGEDUCA_MS_HS_2012<-rename.vars(DIGEDUCA_2009_2012, c(
"PRIMER_NOMBRE",
"SEGUNDO_NOMBRE",
"PRIMER_APELLIDO",
"SEGUNDO_APELLIDO", 
"BARCODE_2009", 
"MEASURE_LECTURA_2009", 
"MEASURE_MATE_2009", 
"DESEMPENIO_LECTURA_2009", 
"DESEMPENIO_MATE_2009", 
"LOGRO_LECTURA_2009", 
"LOGRO_MATEMATICAS_2009", 
"MEASURE_LECTURA_2012", 
"MEASURE_MATE_2012", 
"DESEMPENIO_LECTURA_2012", 
"DESEMPENIO_MATE_2012", 
"LOGRO_LECTURA_2012", 
"LOGRO_MATE_2012", 
"CODIGO_ESTABLECIMIENTO_2009", 
"CODIGO_DEPARTAMENTO_2009", 
"CODIGO_MUNICIPIO_2009", 
"CODIGO_JORNADA_2009", 
"CODIGO_NIVEL_2009", 
"CODIGO_SECTOR_2009", 
"CODIGO_AREA_2009", 
"EDAD_RECODE_2009", 
"SEXO_2009", 
"IE_IDENTIFICACION_ETNICA_2009", 
"IE_IDIOMA_MATERNO_2009", 
"BARCODE_2012", 
"COD_DEPA_2012", 
"COD_MUNI_2012",
"COD_ESTAB_2012", 
"EDAD_RECODIFICADA_2012", 
"SEXO_2012", 
"COD_AREA_2012", 
"COD_SECTOR_2012", 
"COD_JORNADA_2012", 
"IE_IDENTIFICACION_ETNICA_2012", 
"IE_IDIOMA_MATERNO_2012"), 

c("FIRST_NAME", 
"MIDDLE_NAME", 
"LAST_NAME_1", 
"LAST_NAME_2", 
"MATCH_VAR_2009", 
"SS_READ_2009", 
"SS_MATH_2009", 
"STAND_READ_2009", 
"STAND_MATH_2009", 
"LOGRO_READ_2009", 
"LOGRO_MATH_2009", 
"SS_READ_HS", 
"SS_MATH_HS", 
"STAND_READ_HS", 
"STAND_MATH_HS", 
"LOGRO_READ_HS", 
"LOGRO_MATH_HS",
"SCHOOL_2009", 
"STATE_2009", 
"DISTRICT_2009", 
"JORN_2009", 
"LEVEL_2009", 
"SECTOR_2009", 
"AREA_2009", 
"AGE_2009", 
"SEX_2009", 
"ETHNICITY_2009", 
"LANG_2009", 
"MATCH_VAR_HS", 
"STATE_HS", 
"DISTRICT_HS",
"SCHOOL_HS", 
"AGE_HS", 
"SEX_HS", 
"AREA_HS", 
"SECTOR_HS", 
"JORN_HS", 
"ETHNICITY_HS", 
"LANG_HS"))


#DIGEDUCA_MS_HS_2012<-rename.vars(DIGEDUCA_2009_2012, c("CODIGO_ESTABLECIMIENTO_2009", "CODIGO_DEPARTAMENTO_2009", "CODIGO_MUNICIPIO_2009", "CODIGO_JORNADA_2009", "CODIGO_NIVEL_2009", "CODIGO_SECTOR_2009", "CODIGO_AREA_2009", "EDAD_RECODE_2009", "SEXO_2009", "IE_IDENTIFICACION_ETNICA_2009", "IE_IDIOMA_MATERNO_2009", "BARCODE_2012", "COD_DEPA_2012", "COD_MUNI_2012","COD_ESTAB_2012", "EDAD_RECODIFICADA_2012", "SEXO_2012", "COD_AREA_2012", "COD_SECTOR_2012", "COD_JORNADA_2012", "IE_IDENTIFICACION_ETNICA_2012", "IE_IDIOMA_MATERNO_2012"), c("SCHOOL_2009", "STATE_2009", "DISTRICT_2009", "JORN_2009", "LEVEL_2009", "SECTOR_2009", "AREA_2009", "AGE_2009", "SEX_2009", "ETHNICITY_2009", "LANG_2009", "MATCH_VAR_HS", "STATE_HS", "DISTRICT_HS","SCHOOL_HS", "AGE_HS", "SEX_HS", "AREA_HS", "SECTOR_HS", "JORN_HS", "ETHNICITY_HS", "LANG_HS"))



names(DIGEDUCA_MS_HS_2012)
dim(DIGEDUCA_MS_HS_2012)

DIGEDUCA_MS_HS<-rbind(DIGEDUCA_MS_HS_2011, DIGEDUCA_MS_HS_2012)
head(DIGEDUCA_MS_HS)
dim(DIGEDUCA_MS_HS) #N=88,948


DIGEDUCA_MS_HS<-unique(DIGEDUCA_MS_HS)

#CREATE GRADE AND ID VARIABLES
DIGEDUCA_MS_HS$GRADE_2009<-9
DIGEDUCA_MS_HS$GRADE_HS<-12

#CREATE A UNIQUE IDENTIFIER
DIGEDUCA_MS_HS$ID<-as.numeric(as.factor(with(DIGEDUCA_MS_HS,
paste(FIRST_NAME, 
MIDDLE_NAME, 
LAST_NAME_1, 
LAST_NAME_2, 
MATCH_VAR_2009, 
SS_READ_2009, 
SS_MATH_2009, 
STAND_READ_2009, 
STAND_MATH_2009, 
LOGRO_READ_2009, 
LOGRO_MATH_2009, 
SS_READ_HS, 
SS_MATH_HS, 
STAND_READ_HS, 
STAND_MATH_HS, 
LOGRO_READ_HS, 
LOGRO_MATH_HS, 
SCHOOL_2009, 
STATE_2009, 
DISTRICT_2009, 
JORN_2009, 
LEVEL_2009, 
SECTOR_2009, 
AREA_2009, 
AGE_2009, 
SEX_2009, 
ETHNICITY_2009, 
LANG_2009, 
MATCH_VAR_HS, 
STATE_HS, 
DISTRICT_HS,
SCHOOL_HS, 
AGE_HS, 
SEX_HS, 
AREA_HS, 
SECTOR_HS, 
JORN_HS, 
ETHNICITY_HS, 
LANG_HS, sep="_"))))

#student growth percentiles ms and hs
require(SGP)
sgp_DIGEDUCA_Reading_HS <- studentGrowthPercentiles(panel.data=DIGEDUCA_MS_HS,
                   sgp.labels=list(my.year=2012, my.subject="Reading"),
                   panel.data.vnames=c("ID", "GRADE_2009", "GRADE_HS", "SS_READ_2009", "SS_READ_HS"),
                   percentile.cuts=c(1,35,65,99),
                   percuts.digits=2,
                   drop.nonsequential.grade.progression.variables=FALSE,
                   grade.progression=c(9,12))
                   
names(sgp_DIGEDUCA_Reading_HS$SGPercentiles)


setwd("/Users/Leslie/Repository/Dropbox/Eriko")